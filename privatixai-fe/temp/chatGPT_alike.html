<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PrivatixAI</title>
  <style>
    :root{
      --brand-navy:#1A2C4B;
      --accent:#00D4FF;
      --bg:#F5F7FA;
      --ink:#1f2937;
      --muted:#6b7280;
      --ring:#cbd5e1;
      --card:#ffffff;
    }
    html,body{height:100%}
    body{
      margin:0; font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background:var(--bg); color:var(--ink); -webkit-font-smoothing:antialiased;
    }
    .wrap{min-height:100%; display:grid; grid-template-rows:auto 1fr auto}
    header{
      display:flex; align-items:center; gap:.75rem; padding:18px 20px;
      border-bottom:1px solid #e5e7eb; background:var(--card);
    }
    header img.logo{height:32px; width:auto}
    header .brand{font-weight:700; letter-spacing:.2px; color:var(--brand-navy)}
    main{display:grid; place-items:center; padding:28px}
    .hero{max-width:920px; width:100%}
    .title{
      text-align:center; font-weight:600; font-size:28px; margin:34px 0 22px;
      color:var(--brand-navy);
    }
    .searchbar{
      display:flex; align-items:center; gap:12px; width:100%;
      background:#0b122000; justify-content:center;
    }
    .input-shell{
      display:flex; align-items:center; gap:8px;
      background:var(--card); border:1px solid var(--ring); border-radius:999px;
      padding:10px 12px; width:min(820px, 94vw); box-shadow:0 1px 2px rgba(0,0,0,.04);
    }
    .icon-btn{
      display:grid; place-items:center; width:36px; height:36px;
      border-radius:999px; border:1px solid transparent; background:#f1f5f9;
      cursor:pointer; transition:transform .05s ease, background .15s ease;
    }
    .icon-btn:hover{background:#e2e8f0}
    .icon-btn:active{transform:scale(.97)}
    .icon-btn svg{width:18px; height:18px; color:#0f172a}
    .input{
      flex:1; border:none; outline:none; font-size:16px; background:transparent; color:var(--ink);
    }
    .hint{margin-top:10px; text-align:center; color:var(--muted); font-size:13px}
    .section{
      margin:28px auto 0; max-width:min(920px, 94vw); background:var(--card);
      border:1px solid #e5e7eb; border-radius:16px; overflow:hidden;
    }
    .section header{border:0; padding:14px 18px; background:linear-gradient(180deg,#fff, #fafafa)}
    .section header h2{margin:0; font-size:14px; color:#334155; font-weight:600}
    .list{display:grid}
    .chat-item{
      padding:14px 18px; border-top:1px solid #eef2f7; display:flex; gap:10px; align-items:flex-start;
      cursor:pointer; background:#fff; transition:background .15s ease;
    }
    .chat-item:hover{background:#fafcff}
    .dot{width:9px; height:9px; border-radius:999px; background:var(--accent); margin-top:6px; flex:0 0 9px}
    .chat-title{font-size:15px; line-height:1.35; color:#111827}
    .chat-meta{font-size:12px; color:var(--muted); margin-top:2px}
    .empty{padding:24px 18px; color:var(--muted); font-size:14px}

    /* Modal */
    .modal{
      position:fixed; inset:0; display:none; place-items:center; background:rgba(2,6,23,.45); backdrop-filter:saturate(120%) blur(2px); z-index:50;
    }
    .modal[open]{display:grid}
    .dialog{
      width:min(760px, 94vw); background:var(--card); border-radius:16px; border:1px solid #e5e7eb;
      box-shadow:0 10px 30px rgba(0,0,0,.15);
    }
    .dialog header{display:flex; align-items:center; gap:10px; padding:14px 16px; border-bottom:1px solid #eef2f7}
    .dialog header h3{margin:0; font-size:16px}
    .dialog .search-row{
      display:flex; align-items:center; gap:8px; padding:12px 16px;
      border-bottom:1px solid #f1f5f9; background:#fafcff;
    }
    .dialog .search-row input{flex:1; padding:10px 12px; border-radius:10px; border:1px solid var(--ring); font-size:14px}
    .dialog .results{max-height:52vh; overflow:auto; padding:8px}
    .dialog .result{padding:12px 10px; border-radius:10px; cursor:pointer}
    .dialog .result:hover{background:#f7fafc}
    .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Courier New", monospace; font-size:12px; border:1px solid #e5e7eb; padding:1px 5px; border-radius:6px; background:#fff}
    footer{padding:18px; text-align:center; color:#94a3b8; font-size:12px}
    .sr-only{position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <img class="logo" src="PrivatixAI Logo.png" alt="PrivatixAI logo" />
      <div class="brand">PrivatixAI</div>
    </header>

    <main>
      <div class="hero" role="region" aria-label="Chat entry">
        <div class="title">How can I help, Luis?</div>

        <div class="searchbar">
          <div class="input-shell" role="search">
            <!-- Upload button -->
            <button class="icon-btn" id="uploadBtn" aria-label="Upload files">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7 10 12 5 17 10"/>
                <line x1="12" y1="5" x2="12" y2="16"/>
              </svg>
            </button>
            <input id="prompt" class="input" type="text" placeholder="Ask anything" aria-label="Ask anything" />
            <!-- Search other chats -->
            <button class="icon-btn" id="openSearch" aria-label="Search previous chats">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
            </button>
          </div>
        </div>
        <div class="hint">Press <span class="kbd">Enter</span> to start a new chat ‚Ä¢ <span class="kbd">/</span> to search previous chats</div>

        <!-- Recent chats -->
        <section class="section" aria-label="Previous chats">
          <header><h2>Previous chats</h2></header>
          <div id="chatList" class="list" role="list"></div>
        </section>
      </div>
    </main>

    <footer>üîê Your data stays on your device ‚Ä¢ v0.1</footer>
  </div>

  <!-- Search modal -->
  <div class="modal" id="searchModal" aria-modal="true" role="dialog" aria-labelledby="searchTitle">
    <div class="dialog">
      <header>
        <h3 id="searchTitle">Search previous chats</h3>
        <div style="margin-left:auto; color:#64748b; font-size:12px">Press <span class="kbd">Esc</span> to close</div>
      </header>
      <div class="search-row">
        <input id="searchInput" type="text" placeholder="Type to filter by title or preview‚Ä¶" aria-label="Search text" />
      </div>
      <div id="searchResults" class="results" role="listbox" aria-label="Search results"></div>
    </div>
  </div>

  <!-- Hidden file input -->
  <input id="fileInput" class="sr-only" type="file" multiple />

  <script>
    // ---- Mock chat data (replace with real data source) ----
    const mockChats = [
      { id: "c1", title: "GDPR notes summary", preview: "Summarize articles 5‚Äì7 and DPIA impact‚Ä¶", ts: "Today" },
      { id: "c2", title: "Lecture ‚Äì Prof. Becker on fines", preview: "What did he say about turnover-based fines?", ts: "Yesterday" },
      { id: "c3", title: "NDA clause 9.2 finder", preview: "Show all NDAs mentioning clause 9.2", ts: "2 days ago" },
      { id: "c4", title: "Thesis references clean-up", preview: "Extract citations with DOI only", ts: "2 days ago" },
      { id: "c5", title: "Podcast #41 highlights", preview: "Find story about the Berlin client", ts: "Last week" },
    ];
    // Ensure max 20
    const chats = (JSON.parse(localStorage.getItem("privx_chats")||"null") || mockChats).slice(0,20);

    // ---- Render previous chats ----
    const list = document.getElementById("chatList");
    function renderChats(items){
      list.innerHTML = "";
      if(!items.length){
        list.innerHTML = `<div class="empty">No chats yet. Start one above.</div>`;
        return;
      }
      items.forEach(c=>{
        const row = document.createElement("div");
        row.className = "chat-item"; row.role = "listitem"; row.tabIndex = 0;
        row.innerHTML = `
          <div class="dot" aria-hidden="true"></div>
          <div>
            <div class="chat-title">${escapeHtml(c.title)}</div>
            <div class="chat-meta">${escapeHtml(c.preview)} ‚Ä¢ ${escapeHtml(c.ts)}</div>
          </div>`;
        row.addEventListener("click", ()=> openChat(c.id));
        row.addEventListener("keydown", (e)=>{ if(e.key==="Enter") openChat(c.id); });
        list.appendChild(row);
      });
    }
    renderChats(chats);

    function openChat(id){
      // Placeholder: plug into router/state to open the conversation
      alert("Open chat: " + id);
    }

    function escapeHtml(s){
      return s.replace(/[&<>"']/g, (m)=>({ "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#039;" }[m]));
    }

    // ---- Upload flow ----
    const uploadBtn = document.getElementById("uploadBtn");
    const fileInput = document.getElementById("fileInput");
    uploadBtn.addEventListener("click", ()=> fileInput.click());
    fileInput.addEventListener("change", ()=>{
      if(!fileInput.files.length) return;
      const names = [...fileInput.files].map(f=> f.name).slice(0,5).join(", ");
      alert(`Queued ${fileInput.files.length} file(s): ${names}`);
      fileInput.value = ""; // reset
      // TODO: hand off to ingestion pipeline
    });

    // ---- Search modal ----
    const modal = document.getElementById("searchModal");
    const openSearch = document.getElementById("openSearch");
    const searchInput = document.getElementById("searchInput");
    const searchResults = document.getElementById("searchResults");

    function openModal(){
      modal.setAttribute("open",""); searchInput.value=""; renderSearch("");
      setTimeout(()=> searchInput.focus(), 50);
    }
    function closeModal(){ modal.removeAttribute("open"); }
    openSearch.addEventListener("click", openModal);
    document.addEventListener("keydown", e=>{
      if(e.key==="/" && document.activeElement.id!=="searchInput" && !modal.hasAttribute("open")){ e.preventDefault(); openModal(); }
      if(e.key==="Escape" && modal.hasAttribute("open")) closeModal();
    });
    modal.addEventListener("click", (e)=>{ if(e.target===modal) closeModal(); });

    function renderSearch(q){
      const qn = q.trim().toLowerCase();
      const filtered = chats.filter(c=> !qn || c.title.toLowerCase().includes(qn) || c.preview.toLowerCase().includes(qn));
      searchResults.innerHTML = filtered.map(c=> `
        <div class="result" role="option" data-id="${c.id}">
          <div style="font-weight:600">${escapeHtml(c.title)}</div>
          <div style="color:#64748b; font-size:12px">${escapeHtml(c.preview)} ‚Ä¢ ${escapeHtml(c.ts)}</div>
        </div>`).join("") || `<div class="empty">No matches.</div>`;
      [...searchResults.querySelectorAll(".result")].forEach(el=>{
        el.addEventListener("click", ()=> { closeModal(); openChat(el.dataset.id); });
      });
    }
    searchInput.addEventListener("input", (e)=> renderSearch(e.target.value));
  </script>
</body>
</html>
